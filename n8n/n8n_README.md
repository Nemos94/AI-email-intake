# n8n – Email Intake & Orchestration Workflow

## Overview
This folder documents the **n8n automation workflow** responsible for orchestrating
the AI-powered email intake process.

The workflow receives **real customer emails**, prepares the data for AI analysis,
routes the result based on business logic, and triggers Salesforce record creation.

For clarity and security reasons, the workflow is documented using **screenshots and
technical descriptions** rather than raw JSON exports.

---

## Workflow Responsibilities

The n8n workflow acts as the **central orchestration layer**, responsible for:

- Receiving real emails from Gmail
- Normalizing and extracting message content
- Sending the message to the AI backend
- Routing requests based on AI output (Case vs Lead)
- Creating Salesforce records
- Delegating business logic to Salesforce Flow

---

## High-Level Flow

```
Gmail Trigger
     ↓
Message Normalization
     ↓
AI Intake API (FastAPI + OpenAI)
     ↓
Decision Logic (Case vs Lead)
     ↓
Salesforce Record Creation
```

---
**Screenshot:** `n8n\n8n_Architecture_Intake.png`

## Nodes Description

### 1. Gmail Trigger
- Listens to a real Gmail inbox
- Triggers only for new incoming messages
- Acts as the entry point of the automation



---

### 2. Message Normalization (Set Node)
- Extracts the email body (plain text or snippet)
- Removes unnecessary metadata
- Prepares a clean payload for AI analysis

**Key fields prepared:**
- `message`
- `source`


---

### 3. AI Intake API (HTTP Request)
- Sends the normalized message to a FastAPI backend
- Receives a strictly validated JSON response generated by AI

The AI response includes:
- Object type (Case or Lead)
- Category
- Priority
- Sentiment
- Summary
- Suggested response


---

### 4. Decision Logic (IF Node)
- Routes the workflow based on `objectType`
- Ensures different business paths for:
  - Support Cases
  - Sales Leads

This mirrors Salesforce routing logic and keeps the automation flexible.


---

### 5. Salesforce Integration
- Creates a Salesforce Case or Lead
- Maps AI-generated fields into Salesforce-safe formats
- Triggers a record-based Salesforce Flow

---

## Design Principles

- **Decoupled architecture**: n8n orchestrates, AI reasons, Salesforce executes
- **Contract-first integration**: AI output is strictly validated
- **Human-in-the-loop**: no automatic external communication
- **Low maintenance**: declarative logic over custom code
- **Security by design**: no credentials stored in version control

---

## Security Notes

- No credentials, tokens, or secrets are stored in this repository
- n8n credentials are referenced internally and remain encrypted
- Screenshots are used instead of raw workflow exports for safety and readability

---

## Outcome

This workflow enables:
- Faster email triage
- Consistent prioritization
- Reduced manual effort
- Safe and governed AI adoption in Salesforce environments

---

## Notes

- The workflow is intended as a **portfolio and reference implementation**
- Not designed to be imported and executed directly without configuration
